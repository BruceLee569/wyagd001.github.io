<!DOCTYPE HTML>
<html>
<head>
<title>Shutdown | AutoHotkey</title>
<meta name="description" content="The Shutdown command shuts down, restarts, or logs off the system." />
<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script type="text/javascript">$(function(){0<=window.navigator.userAgent.toLowerCase().indexOf("ucbrowser")&&CaoNiMaDeUc()})</script>
</head>
<body>

<h1>Shutdown</h1>

<p>关闭, 重启或注销系统.</p>

<pre class="Syntax"><span class="func">Shutdown</span>, Flag</pre>
<h2 id="Parameters">参数</h2>
<dl>

  <dt>Flag</dt>
  <dd>
    <p>A combination (sum) of the following numbers:</p>
    <ul>
      <li>0 = 注销</li>
      <li>1 = 关机</li>
      <li>2 = 重启</li>
      <li>4 = 强制</li>
      <li>8 = 关闭电源</li>
    </ul>
    <p>Add the required values together. For example, to shutdown and power down the flag would be 9 (shutdown + power down = 1 + 8 = 9). Alternatively, an <a href="../Variables.htm#Expressions">expression</a> such as 1+8 can be specified.</p>
    <p>The "Force" value (4) forces all open applications to close. It should only be used in an emergency because it may cause any open applications to lose data.</p>
    <p>The "Power down" value (8) shuts down the system and turns off the power.</p>
    
    <p>把需要的值加在一起. 例如, 要关闭并切断电源的代码为 <strong>9</strong>(关闭 + 切断电源 = 1 + 8 = 9). 或者, 可以使用<a href="../Variables.htm#Expressions">表达式</a>, 例如 1+8.</p>
<p>使用 "强制" 值(4) 来强制关闭所有打开的应用程序. 它应该仅用于紧急的情况中, 因为这样可能导致打开的应用程序数据丢失.</p>
<p>"断电" 数值表示关闭系统并切断电源.</p>

  </dd>

</dl>

<h2 id="Remarks">备注</h2>
<p>To have the system suspend or hibernate, see <a href="#Suspend">example #2</a> at the bottom of this page.</p>
<p>To turn off the monitor, see <a href="PostMessage.htm#ExMonitorPower">PostMessage example #1</a>.</p>
<p>相关提示, 脚本通过 <a href="OnExit.htm#function">OnExit()</a> 或 <a href="OnExit.htm#command">OnExit</a> 可以检测到系统正在关闭或用户正在注销.</p>
<h2 id="Related">相关</h2>
<p><a href="Run.htm">Run</a>, <a href="ExitApp.htm">ExitApp</a>, <a href="OnExit.htm#function">OnExit()</a>, <a href="OnExit.htm#command">OnExit</a></p>
<h2 id="Examples">示例</h2>
<div class="ex" id="ExBasic">
<p><a class="ex_number" href="#ExBasic"></a> 强制重新启动(重启 + 强制 = 2 + 4 = 6).</p>
<pre>Shutdown, 6</pre>
</div>

<div class="ex" id="Suspend">
<p><a class="ex_number" href="#Suspend"></a> 调用 Windows API 函数 "SetSuspendState" 来让系统挂起或休眠. Note that the second parameter may have no effect at all on newer systems.</p>
<pre><em>; 参数 #1: 使用 1 代替 0 来进行休眠而不是挂起.
; 参数 #2: 使用 1 代替 0 来立即挂起而不询问每个应用程序以获得许可.
; 参数 #3: 使用 1 而不是 0 来禁止所有的唤醒事件.</em>
DllCall("PowrProf\SetSuspendState", "int", 0, "int", 0, "int", 0)</pre>
</div>

</body>
</html>