<!DOCTYPE HTML>
<html>
<head>
<title>WinGet | AutoHotkey</title>
<meta name="description" content="The WinGet command retrieves the specified window's unique ID, process ID, process name, a list of its controls, or a list of windows." />
<meta name="ahk:equiv-v2" content="commands/Win.htm" />
<meta http-equiv="content-type" content="text/html; charset=gb2312">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script type="text/javascript">$(function(){0<=window.navigator.userAgent.toLowerCase().indexOf("ucbrowser")&&CaoNiMaDeUc()})</script>
</head>
<body>

<h1>WinGet</h1>

<p>???????????Ψ? ID, ???? ID(PID), ???????????б?. ?????????????????????????д?????б?.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar <span class="optional">, <a href="#SubCommands">SubCommand</a>, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>

<h2>????</h2>
<dl>
  <dt>OutputVar</dt>
  <dd>???????? <em>SubCommand</em> ??????????.</dd>

  <dt>SubCommand</dt>
  <dd>???е????, ?????????? <a href="#ID">ID</a> ??????. ?????<a href="#SubCommands">??????</a>.</dd>

  <dt>WinTitle</dt>
  <dd>?????????????????????????. ????? <a href="../misc/WinTitle.htm">WinTitle</a>.</dd>

  <dt>WinText</dt>
  <dd>??????????, ?????????????????е?????????????????(??????? Window Spy ????????????). ?? <a href="DetectHiddenText.htm">DetectHiddenText</a> ??????? ON ?, ?????????????????.</dd>

  <dt>ExcludeTitle</dt>
  <dd>?????к??д????????????????.</dd>

  <dt>ExcludeText</dt>
  <dd>????к??д????????????????.</dd>
</dl>

<h2 id="SubCommands">??????</h2>
<p>???? <em>SubCommand</em>, ?????????????:</p>
<ul>
    <li><a href="#ID">ID</a>: ????????Ψ? ID ??.</li>
    <li><a href="#IDLast">IDLast</a>: ??????????????, ??????????/??????????Ψ? ID.</li>
    <li><a href="#PID">PID</a>: ??????????? ID.</li>
    <li><a href="#ProcessName">ProcessName</a>: ?????д?????????.</li>
    <li><a href="#ProcessPath">ProcessPath</a> <span class="ver">[v1.1.01+]</span>: ?????д????????????·????????.</li>
    <li><a href="#Count">Count</a>: ????????/??????????????д????????.</li>
    <li><a href="#List">List</a>: ?????/????????????????????д????Ψ? ID ??.</li>
    <li><a href="#MinMax">MinMax</a>: ??????????С??/?????.</li>
    <li><a href="#ControlList">ControlList</a>: ?????????????????????.</li>
    <li><a href="#ControlListHwnd">ControlListHwnd</a> <span class="ver">[v1.0.43.06+]</span>: ?????????????????Ψ? ID ??.</li>
    <li><a href="#Transparent">Transparent</a>: ????????????????.</li>
    <li><a href="#TransColor">TransColor</a>: ?????????б???????????.</li>
    <li><a href="#Style">Style</a>: ??????????????? 8 λ???????????.</li>
    <li><a href="#ExStyle">ExStyle</a>: ?????????????????? 8 λ???????????.</li>
</ul>

<h3 id="ID">ID</h3>
<p>????????Ψ? ID ??.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, ID <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>????<a href="ControlGet.htm#Hwnd">??????(HWND)</a>. ???????????, ??? <em>OutputVar</em> ?????. ??? <a href="WinExist.htm">WinExist()</a> ?? <a href="WinActive.htm">WinActive()</a> ???????????????? ID; ????, <code>WinExist(&quot;A&quot;)</code> ????????????? ID. ????????? HWND(???? <a href="PostMessage.htm">Post/SendMessage</a> ?? <a href="DllCall.htm">DllCall</a>), ????? <a href="ControlGet.htm#Hwnd">ControlGet Hwnd</a> ?? <a href="MouseGetPos.htm">MouseGetPos</a>.</p>

<h3 id="IDLast">IDLast</h3>
<p>??????????????, ??????????/??????????Ψ? ID.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, IDLast <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>????<a href="ControlGet.htm#Hwnd">??????(HWND)</a>. ?????????????, ?? <em>OutputVar</em> ?????. ????????????, ???????Ч???? <a href="#ID">ID</a> ?????????. ?????????????? <a href="WinActivateBottom.htm">WinActivateBottom</a>.</p>

<h3 id="PID">PID</h3>
<p>????????<a href="Process.htm">???? ID</a>.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, PID <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>?????????????, ?? <em>OutputVar</em> ?????.</p>

<h3 id="ProcessName">ProcessName</h3>
<p>?????д?????????.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, ProcessName <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>????, ?????? "notepad.exe". ???????????, ??? <em>OutputVar</em> ?????.</p>

<h3 id="ProcessPath">ProcessPath <span class="ver">[v1.1.01+]</span></h3>
<p>?????д????????????·????????.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, ProcessPath <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>????, ?????? "C:\Windows\System32\notepad.exe". ???????????, ??? <em>OutputVar</em> ?????.</p>

<h3 id="Count">Count</h3>
<p>????????/??????????????д????????.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, Count <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>???????????, <em>OutputVar</em> ??? 0. ???????????????д?????, ????????е????????/???????. ?????? <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> ??????????????????.</p>

<h3 id="List">List</h3>
<p>?????/????????????????????д????Ψ? ID ??.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, List <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>???????????????д???, ??????е????????/???????. ??? ID ????????????? <em>OutputVar</em> ??????????????????(???????<a href="../misc/Arrays.htm#pseudo">α????</a>), ?? <em>OutputVar</em> ????????????????????(?????? 0). ????, ??? <em>OutputVar</em> ?? MyArray ????????????????, ??? MyArray1 ??????????????? ID, MyArray2 ????????????????? ID ?, MyArray ?????????????? 2. ???????????????????浽??????(??????????????????????). ?????? <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> ??????????????????. ??<a href="../Functions.htm">????</a>??, ?????????????????α????, ???????????????<a href="../Functions.htm#Global">????</a> MyArray ???????(????<a href="../Functions.htm#AssumeGlobal">???????</a>????, ??????). ????, ????????????????????????, ???????????<a href="../Functions.htm#ArrayConfusion">???????</a>.</p>

<h3 id="MinMax">MinMax</h3>
<p>??????????С??/?????.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, MinMax <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>??????????????, ?? <em>OutputVar</em> ?????; ????, ?????????????????????????:</p>
<ul>
  <li>-1: ?????????С????(??? <a href="WinRestore.htm">WinRestore</a> ???????????).</li>
  <li>1: ????????????(??? <a href="WinRestore.htm">WinRestore</a> ???????????).</li>
  <li>0: ????????????С????????????????.</li>
</ul>

<h3 id="ControlList">ControlList</h3>
<p>?????????????????????.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, ControlList <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>??????????????????п??, ??? <em>OutputVar</em> ?????. ????, ???????????????????????, ????????(ClassNN), ??? Window Spy ?????????.</p>
<p>?????????????????????з?????(`n). ???????????????????, ?????<a href="LoopParse.htm">???????</a>, ????????<a href="#ExControlList">??? #3</a>.</p>
<p>???????? Z ??????????, ?????????????, Z ????????????? <kbd>Tab</kbd> ?????????????.</p>

<h3 id="ControlListHwnd">ControlListHwnd <span class="ver">[v1.0.43.06+]</span></h3>
<p>?????????????????Ψ? ID ??.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, ControlListHwnd <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>??????????????????п??, ??? <em>OutputVar</em> ?????. ????, ???Ψ? ID ????????<a href="ControlGet.htm#Hwnd">??????(HWND)</a>. ????????????????????з?(`n) ????.</p>
<p>???????? Z ??????????, ?????????????, Z ????????????? <kbd>Tab</kbd> ?????????????.</p>

<h3 id="Transparent">Transparent</h3>
<p>????????????????.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, Transparent <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>????? <a href="WinSet.htm">WinSet</a> ???????????????. ?????????Щ????, <em>OutputVar</em> ?????: 1) ?????????? Windows XP; 2) ????????; 3) ??????????????????; ?? 4) ???????(??????????????), ??????????????????С??, ?????/???????С. ????, ???洢??????? 0 ?? 255 ????????, ???? 0 ????????????, ?? 255 ?????????????. ????:</p>
<pre>MouseGetPos,,, MouseWin
WinGet, Transparent, Transparent, ahk_id %MouseWin%  <em>; ??????????????.</em></pre>

<h3 id="TransColor">TransColor</h3>
<p>?????????б???????????.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, TransColor <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>????? <a href="WinSet.htm#TransColor">WinSet</a> ?????????? TransColor. ?????????Щ????, <em>OutputVar</em> ?????: 1) ?????????? Windows XP; 2) ????????; 3) ???????????; ?? 4) ???????(??????????????), ??????????????????С??, ?????/???????С. ????, ???洢?????λ????????? RGB ????, ???? 0x00CC99. ????:</p>
<pre>MouseGetPos,,, MouseWin
WinGet, TransColor, TransColor, ahk_id %MouseWin%  <em>; ???????????????.</em></pre>

<h3 id="Style">Style</h3>
<p>??????????????? 8 λ???????????.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, Style <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>???????????, ??? <em>OutputVar</em> ?????. ??????????ж????????? WS_DISABLED ???:</p>
<pre>WinGet, Style, Style, My Window Title
if (Style &amp; 0x8000000)  <em>; 0x8000000 is WS_DISABLED.</em>
  MsgBox The window is disabled.</pre>
<p>?????<a href="../misc/Styles.htm">?????</a>????????????????б?.</p>

<h3 id="ExStyle">ExStyle</h3>
<p>?????????????????? 8 λ???????????.</p>
<pre class="Syntax"><span class="func">WinGet</span>, OutputVar, ExStyle <span class="optional">, WinTitle, WinText, ExcludeTitle, ExcludeText</span></pre>
<p>???????????, ??? <em>OutputVar</em> ?????. ??????????ж????????? WS_EX_TOPMOST ???(???):</p>
<pre>WinGet, ExStyle, ExStyle, My Window Title
if (ExStyle &amp; 0x8)  <em>; 0x8 is WS_EX_TOPMOST.</em>
   MsgBox The window is always-on-top.</pre>
<p>?????<a href="../misc/Styles.htm">?????</a>????????????????б?.</p>

<h2>???</h2>
<p>????? ID ???????????????????Ч. ???仰?, ???????????ó???, ?????е????????????? ID ??.</p>
<p>??????????? ID ?????????(???????? &quot;ahk_id&quot;), ????? <a href="SetFormat.htm">SetFormat</a> ??????????????????????.</p>
<p>?????????????? ID ??????? <a href="MouseGetPos.htm">MouseGetPos</a> ???.</p>
<p>???? ID ?????? 32 λ?????????, ?????????汾???????????? 64 λ. ???, ????Щ?????????????????????????????, ?????Щ????????????????????????з??????????????????.</p>
<p>??????????????????Сд??. ?????? <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> ?????, ?????????????.</p>

<h2>???</h2>
<p><a href="WinGetClass.htm">WinGetClass</a>, <a href="Process.htm">Process</a>, <a href="WinGetTitle.htm">WinGetTitle</a>, <a href="MouseGetPos.htm">MouseGetPos</a>, <a href="ControlGet.htm">ControlGet</a>, <a href="ControlFocus.htm">ControlFocus</a>, <a href="GroupAdd.htm">GroupAdd</a></p>

<h2>???</h2>

<div class="ex" id="ExID">
<p><a href="#ExID">#1</a>: ???????????????Ψ? ID:</p>
<pre>WinGet, active_id, ID, A
WinMaximize, ahk_id %active_id%
MsgBox, The active window's ID is &quot;%active_id%&quot;.</pre>
</div>

<div class="ex" id="ExList">
<p><a href="#ExList">#2</a>: ???????????????д???????????????:</p>
<pre>WinGet, id, List,,, Program Manager
Loop, %id%
{
    this_id := id%A_Index%
    WinActivate, ahk_id %this_id%
    WinGetClass, this_class, ahk_id %this_id%
    WinGetTitle, this_title, ahk_id %this_id%
    MsgBox, 4, , Visiting All Windows`n%A_Index% of %id%`nahk_id %this_id%`nahk_class %this_class%`n%this_title%`n`nContinue?
    IfMsgBox, NO, break
}</pre>
</div>

<div class="ex" id="ExControlList">
<p><a href="#ExControlList">#3</a>: ???????????б??????????????????:</p>
<pre>WinGet, ActiveControlList, ControlList, A
Loop, Parse, ActiveControlList, `n
{
    MsgBox, 4,, Control #%A_Index% is &quot;%A_LoopField%&quot;. Continue?
    IfMsgBox, No
        break
}</pre>
</div>

<div class="ex" id="ExRealTime">
<p><a href="#ExRealTime">#4</a>: ???????????????б?:</p>
<pre>#Persistent
SetTimer, WatchActiveWindow, 200
return

WatchActiveWindow:
WinGet, ControlList, ControlList, A
ToolTip, %ControlList%
return</pre>
</div>

</body>
</html>