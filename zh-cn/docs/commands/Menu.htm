<!DOCTYPE HTML>
<html>
<head>
<title>Menu | AutoHotkey</title>
<meta name="description" content="The Menu command creates, deletes, modifies and displays menus and menu items, changes the tray icon and its tooltip, or controls whether the main window of a compiled script can be opened." />
<meta name="ahk:equiv-v2" content="objects/Menu.htm" />
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script type="text/javascript">$(function(){0<=window.navigator.userAgent.toLowerCase().indexOf("ucbrowser")&&CaoNiMaDeUc()})</script>
</head>
<body>

<h1>Menu</h1>

<p>????, ???, ????????????????. ??????????????????. ???????????<a href="Scripts.htm#ahk2exe">???????</a>????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, <a href="#SubCommands">SubCommand</a> <span class="optional">, Value1, Value2, Value3, Value4</span></pre>
<p><em>MenuName</em> ?????????? <code>Tray</code> ???κ??????????????. ???????????????? <a href="#Add">Add</a> ??????????????. ????: <code>Menu, MyMenu, Add, Item1</code>. ??????, ??????? <a href="#Show">Show</a> ????????????????. ?????????? <a href="#Add">Add</a> ??????????????????????????????????.</p>
<p><em>SubCommand</em>, <em>Value1</em>, <em>Value2</em>, <em>Value3</em> ?? <em>Value4</em> ??????????, ??????÷?????????.</p>

<h2 id="toc">??</h2>
<ul>
    <li><a href="#SubCommands">??????</a></li>
    <li><a href="#MenuItemName"><em>MenuItemName</em> ????</a></li>
    <li><a href="#Win32_Menus">Win32 ???</a></li>
    <li><a href="#Remarks">???</a></li>
    <li><a href="#Related">???</a></li>
    <li><a href="#Examples">???</a></li>
</ul>

<h2 id="SubCommands">??????</h2>
<p>???? <em>SubCommand</em>, ?????????????:</p>
<ul>
    <li><a href="#Add">Add</a>: ???????????, ????????????????????????????, ??????????????????(????).</li>
    <li><a href="#Insert">Insert</a> <span class="ver">[v1.1.23+]</span>: ??????????????????????????.</li>
    <li><a href="#Delete">Delete</a>: ??????????????????.</li>
    <li><a href="#DeleteAll">DeleteAll</a>: ??????????????????????.</li>
    <li><a href="#Rename">Rename</a>: ???????????????.</li>
    <li><a href="#Check">Check</a>: ????????????????????.</li>
    <li><a href="#Uncheck">Uncheck</a>: ??????????????????????.</li>
    <li><a href="#ToggleCheck">ToggleCheck</a>: ???????????????????????; ??????????, ???????.</li>
    <li><a href="#Enable">Enable</a>: ?????????????(??????????).</li>
    <li><a href="#Disable">Disable</a>: ?????????????.</li>
    <li><a href="#ToggleEnable">ToggleEnable</a>: ?????????????; ??????????, ??????.</li>
    <li><a href="#Default">Default</a>: ?????????????????????????, ???????????.</li>
    <li><a href="#NoDefault">NoDefault</a>: ???????????????????????.</li>
    <li><a href="#Standard">Standard</a>: ??????????????????.</li>
    <li><a href="#NoStandard">NoStandard</a>: ????????????б???????.</li>
    <li><a href="#Icon">Icon</a>: ???????????????? <span class="ver">[AHK_L 17+]</span> ????????????????.</li>
    <li><a href="#NoIcon">NoIcon</a>: ??????????? <span class="ver">[AHK_L 17+]</span> ???????????????????.</li>
    <li><a href="#Tip">Tip</a>: ??????????????????.</li>
    <li><a href="#Show">Show</a>: ??????????.</li>
    <li><a href="#Color">Color</a>: ?????????????.</li>
    <li><a href="#Click">Click</a>: ??????????????????????????????.</li>
    <li><a href="#MainWindow">MainWindow</a>: ??????????????????????????????.</li>
    <li><a href="#NoMainWindow">NoMainWindow</a>: ????????????????????????????.</li>
    <li><a href="#UseErrorLevel">UseErrorLevel</a>: ?????????????????, ?????κξ??????????????.</li>
</ul>

<h3 id="Add">Add</h3>
<p>???????????, ????????????????????????????, ??????????????????(????).</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Add <span class="optional">, MenuItemName, LabelOrSubmenu, Options</span></pre>
<p>??????????????????. <em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>). ??? <em>MenuItemName</em> ????????, ????????????. ????, ???????????? <em>LabelOrSubmenu</em> ???? <em>MenuItemName</em>.</p>
<p>???????????, ?????????????????.</p>
<p>?????????????, ?????????????<a href="../misc/Threads.htm">???</a>????(?????? <a href="Gosub.htm">Gosub</a> ??<a href="../Hotkeys.htm">????????</a>). ?????? <em>LabelOrSubmenu</em>, ???????? <em>MenuItemName</em> ???????????????????.</p>
<p id="Functor"><span class="ver">[v1.1.20+]:</span> ???????????????????, ??? <em>LabelOrSubmenu</em> ??????????????????????, ???????????<a href="../objects/Functor.htm">????????</a>?????. ???? , <code>%funcObj%</code> ?? <code>% funcObj</code>. ?й??????????????, ?????<a href="#ExBoundFunc">??? #5</a>. ???????????????????????. ??????????庯?????????, ????:</p>
<pre><i>FunctionName</i>(ItemName, ItemPos, MenuName)</pre>
<p>??? <em>MenuItemName</em> ???????(??????????????????), ???? <em>LabelOrSubmenu</em> ??????????????????????????? <em>MenuName</em>. ????:</p>
<pre>Menu, MySubmenu, Add, Item1
Menu, Tray, Add, This menu item is a submenu, :MySubmenu</pre>
<p>????????, <em>Options</em> ?????????????????????????????????????б?:</p>
<table class="info">
    <tr>
        <td>P<em>n</em></td>
        <td><em>n</em> ?????????<a href="../misc/Threads.htm">????????</a>, ?? <code>P1</code>. ????????????????????, ????????????????? 0 . ????????????????????, ???????????. ???????????(???????????) ????????.</td>
    </tr>
    <tr>
        <td>+Radio</td>
  <td><span class="ver">[v1.1.23+]:</span> ??в??????????????????????????????.</td>
    </tr>
    <tr>
        <td>+Right</td>
        <td><span class="ver">[v1.1.23+]:</span> ?ò?????е??????????. ????????????<a href="Gui.htm#Menu">?????</a>???????????????????.</td>
    </tr>
    <tr>
        <td>+Break</td>
        <td><span class="ver">[v1.1.23+]:</span> ??????????е????????????п??.</td>
    </tr>
    <tr>
        <td>+BarBreak</td>
        <td><span class="ver">[v1.1.23+]:</span> ???????, ??????????????????????.</td>
    </tr>
</table>
<p>????е???(+) ????????????ü???(-) ?????????????????, ???? <code>-Radio</code> . ????????Сд.</p>
<p>????????????????????, ???????????????????????????? <em>LabelOrSubmenu</em> ????????.</p>

<h3 id="Insert">Insert <span class="ver">[v1.1.23+]</span></h3>
<p>??????????????????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Insert <span class="optional">, MenuItemName, ItemToInsertBefore, LabelOrSubmenu, Options</span></pre>
<p>?÷??????? <a href="#Add">Add</a> ??????, ???? <em>MenuItemName</em> ????????в??????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>), <em>ItemToInsertBefore</em> ????? <em>MenuItemName</em> ??????????????????. ????????????????? <em>MenuItemName</em>(??д????????) ???????. ?? <a href="#Add">Add</a> ???????, Insert ??????????????????, ??? <em>ItemToInsertBefore</em> ?????в????????????.</p>

<h3 id="Delete">Delete</h3>
<p>??????????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Delete <span class="optional">, MenuItemName</span></pre>
<p><em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>). ???????????? "Exit"(?????????) ????????????. ???????? <em>default</em> ?????, ??Ч????????? <a href="#NoDefault">NoDefault</a> ??????????. ????????  <em>MenuItemName</em>, ?????????? <em>MenuName</em> ?????????????????????? <em>MenuName</em> ???κ???????. ?????????????? <a href="#Win32_Menus">Win32 ???</a>???????????????????, ????????????????.</p>

<h3 id="DeleteAll">DeleteAll</h3>
<p>??????????????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, DeleteAll</pre>
<p>?κ????е????????(??????) ??????????. ????? <a href="#Delete">Delete</a> ??????(??????) ????????????, ???????????, ????????κ????????????????????????????Щ????.</p>

<h3 id="Rename">Rename</h3>
<p>??????????????? <em>NewName</em>.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Rename, MenuItemName <span class="optional">, NewName</span></pre>
<p>??? <em>NewName</em> ???, ????????????????????. <em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>). ?????????????????????????. <span class="ver">[v1.1.23+]:</span> ??????????????λ??&amp; ????????? <em>NewName</em> ??????????????????????????, ?????? <a href="#Add">Add</a> ????????????????????????.</p>

<h3 id="Check">Check</h3>
<p>????????????????????(????????).</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Check, MenuItemName</pre>
<p><em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>).</p>

<h3 id="Uncheck">Uncheck</h3>
<p>??????????????????????(?????).</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Uncheck, MenuItemName</pre>
<p><em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>).</p>

<h3 id="ToggleCheck">ToggleCheck</h3>
<p>??????????????и???????????????????; ??????????, ???????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, ToggleCheck, MenuItemName</pre>
<p><em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>).</p>

<h3 id="Enable">Enable</h3>
<p>??????????????????????, ???????????????(?????).</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Enable, MenuItemName</pre>
<p><em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>).</p>

<h3 id="Disable">Disable</h3>
<p>??????????????????, ???????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Disable, MenuItemName</pre>
<p><em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>).</p>

<h3 id="ToggleEnable">ToggleEnable</h3>
<p>??????????????????????????; ????, ??????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, ToggleEnable, MenuItemName</pre>
<p><em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>).</p>

<h3 id="Default">Default</h3>
<p>?????????????????????????, ????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Default <span class="optional">, MenuItemName</span></pre>
<p>???? TRAY ??????????????????????????????????????. <em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>). ????????????????, ???????????????. ???????????, ????????Ч??. ???????? <em>MenuItemName</em>, ??Ч????????????????? <a href="#NoDefault">NoDefault</a> ??????.</p>

<h3 id="NoDefault">NoDefault</h3>
<p>???????????????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, NoDefault</pre>
<p>??????????: ?ò??????????????, ????δ??????? OPEN, ??????<a href="../Scripts.htm#ahk2exe">???????</a>?????(???? <a href="#MainWindow">MainWindow</a> ????????Ч). ?????????????????? <a href="#NoStandard">NoStandard</a> ????????? OPEN ?????????, ???????????????, ????????????????Ч??. ???? TRAY ????????????: ?κ????е?????????????????.</p>

<h3 id="Standard">Standard</h3>
<p>??????????????????(???????????).</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Standard</pre>
<p>??????????????????????????κβ??.</p>

<h3 id="NoStandard">NoStandard</h3>
<p>??????????б??(???????) ??????(???????).</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, NoStandard</pre>
<p>??????????????????????????κβ??.</p>

<h3 id="Icon">Icon</h3>
<p>??????<a href="#TrayIcon">???????</a>?? <span class="ver">[in AHK_L 17+]</span> <a href="#MenuIcon">?????????</a>??????????????????÷?.</p>

<h4 id="TrayIcon">???????????</h4>
<p>???????<a href="../Program.htm#tray-icon">???????</a>? <em>FileName</em> ?е???????.</p>
<pre class="Syntax"><span class="func">Menu</span>, Tray, Icon <span class="optional">, FileName, IconNumber, 1</span></pre>
<p>??????е????????: ICO, CUR, ANI, EXE, DLL, CPL, SCR ???????????????????????. ????????г???????????????, ???? <em>IconNumber</em> ?????????(??????, ???????? 1). ????, <strong>2</strong> ????????????????е???????. ??? <em>IconNumber</em> ?????, ?????????????????????????????? ID. ?? <em>FileName</em> ??????(*) ??????????????????.</p>
<p>??????????: ??????????????? 1 ?????????, ?? 0 ?????(??????????????/????????). ?????????????, <a href="Pause.htm">Pause</a> ?? <a href="Suspend.htm">Suspend</a> ????????. ?: ??????? <em>?????</em> ???, ????? 1 ?? 0, ????: <code>Menu, Tray, Icon,,, 1</code>.</p>
<p>?????????????????? <a href="InputBox.htm">InputBox</a>, <a href="Progress.htm">Progress</a> ??????????? <a href="Gui.htm">GUI</a> ????????????. ??????<a href="../Scripts.htm#ahk2exe">???????</a>, ?????????????????????????.</p>
<p class="note"><strong>???:</strong> ?????????? <a href="_NoTrayIcon.htm">#NoTrayIcon</a> ??????????????????, ????????????????????; ????????, ????? <code>Menu, Tray, Icon</code>(????????).</p>
<p id="distort">?? .ICO ???????????????м??????????????????????????. ????????? 16x16 ?????. ??????????, ????????????????浽 .ICO ???.</p>
<p>???????? DLL ?? CPL ??????????Щ???????????. ????: <code>Menu, Tray, Icon, Shell32.dll, 174</code>.</p>
<p>??????? <strong>A_IconNumber</strong> ?? <strong>A_IconFile</strong> ?????????????????????(??????·??)(????????????????????).</p>
<p><span class="ver">[v1.1.23+]:</span> <a href="../misc/ImageHandles.htm">icon handle(?????)</a> ??????????. ????, <code>Menu Tray, Icon, HICON:*%handle%</code>. ?????????, ????????? "????" ????: ????С???, ?????????.</p>
<p><span class="ver">[v1.1.27+]:</span> <em>?????</em> ???? icon ????? ?? <a href="../misc/ImageHandles.htm">bitmap handles(λ????)</a>. ????, <code>Menu Tray, Icon, HBITMAP:*%handle%</code>.</p>

<h4 id="MenuIcon">???ò???????? <span class="ver">[AHK_L 17+]</span></h4>
<p>????????????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Icon, MenuItemName, FileName <span class="optional">, IconNumber, IconWidth</span></pre>
<p><em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>). <em>FileName</em> ????????????? AutoHotkey ?????????κ????.????????г???????????????, ???? <em>IconNumber</em> ?????????(??????, ???????? 1). ??? <em>IconNumber</em> ?????, ?????????????????????????????? ID. ?? <em>IconWidth</em> ????????????????. ??? <em>IconNumber</em> ??????????????????С?????, ??????????????????????????????С. ?????<a href="#ExIcon">??? #4</a> ???÷????.</p>
<p>????? Windows Vista ?????汾??????????????????????????, ???????? "??????С". ????:</p>
<pre>Menu, <i>MenuName</i>, Icon, <i>MenuItemName</i>, Filename.png,, 0</pre>
<p>???????: ?? Windows XP ?????汾??, Gui ??????е?????????????????λ??.</p>
<p><span class="ver">[v1.1.23+]:</span> <a href="../misc/ImageHandles.htm">λ????????</a>??????????. ????, <code>HBITMAP:%handle%</code>.</p>

<h3 id="NoIcon">NoIcon</h3>
<p>??????<a href="#RemoveTrayIcon">???????</a>?? <span class="ver">[in AHK_L 17+]</span> <a href="#RemoveMenuIcon">?????????</a>, ???????????????????÷?.</p>

<h4 id="RemoveTrayIcon">??????????</h4>
<p>?????????????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, Tray, NoIcon</pre>
<p>???????????????????????, ????????????, ??????????????????????. ????????????, ????? <a href="_NoTrayIcon.htm">#NoTrayIcon</a>. ??????????????????, ????????? <strong>A_IconHidden</strong> ???? 1, ????? 0.</p>

<h4 id="RemoveMenuIcon">???????????? <span class="ver">[AHK_L 17+]</span></h4>
<p>???????????????????(????е??).</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, NoIcon, MenuItemName</pre>
<p><em>MenuItemName</em> ????????????λ??(??????????? <a href="#MenuItemName">MenuItemName</a>).</p>

<h3 id="Tip">Tip</h3>
<p>?????????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, Tray, Tip <span class="optional">, Text</span></pre>
<p>?????????????????????????????????????????. ????????е???????, ???????????????з?(`n), ???? Line1`nLine2. ????? <em>Text</em> ?е?? 127 ?????, ??????? <em>Text</em> ?д??? tab ???, ?????????????????????. ??????? <em>Text</em>, ????????????????????. ??????? <strong>A_IconTip</strong> ??????????????????(???????????????, ?????).</p>

<h3 id="Show">Show</h3>
<p>??? <em>MenuName</em>.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Show <span class="optional">, X, Y</span></pre>
<p>?????????÷????, ???????(????????) ????????????. ???????????????????????κβ??, ?? <a href="Gui.htm">GUI</a> ?????????. ???????? X ?? Y, ?????????????????λ??. ???????????????, ??????????λ????????????. X ?? Y ??????????. ?????? &quot;<a href="CoordMode.htm">CoordMode</a>, Menu&quot; ??????????????????????.</p>

<h3 id="Color">Color</h3>
<p>?????????????? <em>ColorValue</em>.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, Color, ColorValue <span class="optional">, Single</span></pre>
<p><em>ColorValue</em> ?? 16 ?? HTML ??????????? 6 λ?? RGB ????(?????<a href="Progress.htm#colors">??????</a>). ?? <em>ColorValue</em> ???(????????? Default) ????????????????. ??????? Single ???????????????????, ???κθ???????????????????????.</p>

<h3 id="Click">Click</h3>
<p>??????????????????????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, Tray, Click, ClickCount</pre>
<p>?? <em>ClickCount</em> ????? 1 ????????????????????????????. ?? <em>ClickCount</em> ????? 2 ?????????????(???). ????: <code>Menu, Tray, Click, 1</code>.</p>

<h3 id="MainWindow">MainWindow</h3>
<p>???????????????<a href="../Scripts.htm#ahk2exe">???????</a>????????, ??????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, Tray, MainWindow</pre>
<p>?????????????????????? View ?????, ???? &quot;Lines most recently executed&quot;, ?????????????????????????????.</p>

<h3 id="NoMainWindow">NoMainWindow</h3>
<p>??????????????<a href="../Scripts.htm#ahk2exe">???????</a>????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, Tray, NoMainWindow</pre>
<p>?????????????????????. ??????????Ч, ????????????????????????????????????: <a href="ListLines.htm">ListLines</a>, <a href="ListVars.htm">ListVars</a>, <a href="ListHotkeys.htm">ListHotkeys</a> ?? <a href="KeyHistory.htm">KeyHistory</a>.</p>

<h3 id="UseErrorLevel">UseErrorLevel</h3>
<p>?????????????????, ?????κξ??????????????.</p>
<pre class="Syntax"><span class="func">Menu</span>, MenuName, UseErrorLevel <span class="optional">, Off</span></pre>
<p>???????д?δ??ù??????, ???????? OFF. ??? Menu ?????????????, OFF ???????????????????<a href="../misc/Threads.htm">??????</a>. ??? <code>Menu, Tray, UseErrorLevel</code> ????????????????????; ??????, ????????????? <a href="../misc/ErrorLevel.htm">ErrorLevel</a> ??????? 1, ????? 0. ?????????? off, ??????????????? OFF(???? <span class="ver">[v1.1.30+]</span> ??, ??? 0). ????????????, ????ζ??????????е???, ??????? <em>MenuName</em>.</p>

<h2 id="MenuItemName"><em>MenuItemName</em> ????</h2>
<p>???????????λ??. ?Щ??ù????????????????ò???????????:</p>
<ul>
    <li>?????????????????????????, ?????????????? &amp; ????. ?????????????, ??????????????????????????????. ???????? &amp; ????, ????????????, ????????????? &amp; ??: <code>Save &amp;&amp; Exit</code></li>
    <li>?????????????????????????, ????????????Сд?? & ???????. ????: <code>&amp;Open</code></li>
    <li><span class="ver">[v1.1.23+]:</span> ?????????е?λ?????????????, д??ò?????λ?ò?β????? &amp; ??. ????, <code>1&amp;</code> ?????????????.</li>
</ul>

<h2 id="Win32_Menus">Win32 ???</h2>
<p>???????????????л?????, ??????????????????????? Menu ??????????,  ??????? <a href="https://msdn.microsoft.com/en-us/library/ms646977">Win32 ???</a>?????????????. ?????????????????????????????? GUI ??????α???????????????????????"????". ??????????????ζ????? Win32 ?????????, ?丸???????????????????:</p>
<ul>
  <li>??????.</li>
  <li>????????????滻?????????????.</li>
  <li><span class="ver">[v1.1.27.03]</span> ????汾, ?????????? <a href="#NoStandard">NoStandard</a>(???????????) ?? <a href="#DeleteAll">DeleteAll</a>.</li>
</ul>
<p>?κ???? Win32 API ?????????????е????????????????? "???" , ????????????.</p>
<p>???????????????????????????????? ID. ?????????????????????????????? ID, ???????? <a href="MenuGetHandle.htm#Examples">MenuGetHandle ???</a>????????? GetMenuItemID ????? ID. ?? ID ?????????? Menu ??????, ???????????? <a href="https://msdn.microsoft.com/en-us/library/ms646977">Win32 ????</a>.</p>

<h2 id="Remarks">???</h2>
<p>??????????????????:</p>
<img src="../static/pics/ctrl_menu.png" alt="Menu" style="border: 1px solid silver;" />
<p>?????????????????????? 260 ?????.</p>
<p>????????? <code>Menu, <i>MenuName</i>, Add</code> ??????(???????????????в???). <span class="ver">[v1.1.23+]</span>: ?????????????, ????????????е?λ??. ????, ??? <code>Menu, <i>MenuName</i>, Delete, 3&amp;</code> ??????????????????. ?????? <code>Menu, <i>MenuName</i>, DeleteAll</code> ???????????????????.</p>
<p>??????????????????????. ??????????: ??????????????????????????, (?????????????????) ??? <code>Menu, tray, NoStandard</code> ?????????? <code>Menu, tray, Standard</code>.</p>
<p>????????κβ??????????????????????, ???? "Pause Script" ?? "Suspend Hotkeys".</p>
<p>??????????????????????(??????? <code>Menu, MyMenu, DeleteAll</code>), ????????????????. ??????????????, ?????????????????????Ч??(????????? <a href="_NoTrayIcon.htm">#NoTrayIcon</a> ????).</p>
<p>???????????????????????ж???????????????????, ??????????<a href="../misc/Threads.htm">???</a>??????????????, ???ж????????. ??????????????????????, ????????????????? <a href="Critical.htm">Critical</a>(????, ???????????/??????????, ???簴??????).</p>
<p>?????????????????????, ???????????(???? <a href="SendMode.htm">SendMode</a>) ?????????. ??Щ??????????<a href="../Scripts.htm#auto">?????ж?</a>???.</p>
<p>??????? <strong><a href="../Variables.htm#ThisMenuItem">A_ThisMenuItem</a></strong> ?? <strong><a href="../Variables.htm#ThisMenuItemPos">A_ThisMenuItemPos</a></strong> ?????????????????????????????????λ??(???????????). ?????, <strong>A_ThisMenu</strong> ?????? <strong>A_ThisMenuItem</strong> ????????. ??Щ????????????????????????????????????. ???????????, ???????????????????????????????, ????????????????????????????????????.</p>
<p>??÷??????? <a href="Gui.htm">GUI</a> ????????????(?????????????????????????), ????? <a href="_Persistent.htm">#Persistent</a>.</p>

<h2 id="Related">???</h2>
<p><a href="Gui.htm">GUI</a>, <a href="../misc/Threads.htm">???</a>, <a href="Thread.htm">Thread</a>, <a href="Critical.htm">Critical</a>, <a href="_NoTrayIcon.htm">#NoTrayIcon</a>, <a href="Gosub.htm">Gosub</a>, <a href="Return.htm">Return</a>, <a href="SetTimer.htm">SetTimer</a>, <a href="_Persistent.htm">#Persistent</a></p>

<h2>???</h2>

<div class="ex" id="ExBasic">
<p><a href="#ExBasic">#1</a>: ??????????н??, ???????????????????????????:</p>
<pre>#Persistent  <em>; ????????????, ?????????.</em>
Menu, Tray, Add  <em>; ?????????.</em>
Menu, Tray, Add, Item1, MenuHandler  <em>; ??????????.</em>
return

MenuHandler:
MsgBox You selected %A_ThisMenuItem% from menu %A_ThisMenu%.
return</pre>
</div>

<div class="ex" id="ExPopup">
<p><a href="#ExPopup">#2</a>: ???????????????, ??????????????, ????????? <kbd>Win</kbd>+<kbd>Z</kbd> ???????:</p>
<pre><em>; ????Щ??????????????????.</em>
Menu, MyMenu, Add, Item1, MenuHandler
Menu, MyMenu, Add, Item2, MenuHandler
Menu, MyMenu, Add  <em>; ???????.</em>

<em>; ??????????????????.</em>
Menu, Submenu1, Add, Item1, MenuHandler
Menu, Submenu1, Add, Item2, MenuHandler

<em>; ??????????????????(????????). ????????????????????????.</em>
Menu, MyMenu, Add, My Submenu, :Submenu1

Menu, MyMenu, Add  <em>; ???????????????.</em>
Menu, MyMenu, Add, Item3, MenuHandler  <em>; ?????????????????????.</em>
return  <em>; ???????????жν???.</em>

MenuHandler:
MsgBox You selected %A_ThisMenuItem% from the menu %A_ThisMenu%.
return

#z::Menu, MyMenu, Show  <em>; ?????? Win-Z ???????????.</em></pre>
</div>

<<div class="ex" id="ExTray">
<p><a href="#ExTray">#3</a>: ??????????н??, ????????Щ?????????:</p>
<pre>#Persistent
#SingleInstance
Menu, Tray, Add <em>; ????</em>
Menu, Tray, Add, TestToggle&amp;Check
Menu, Tray, Add, TestToggleEnable
Menu, Tray, Add, TestDefault
Menu, Tray, Add, TestStandard
Menu, Tray, Add, TestDelete
Menu, Tray, Add, TestDeleteAll
Menu, Tray, Add, TestRename
Menu, Tray, Add, Test
return

<em>;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</em>

TestToggle&amp;Check:
Menu, Tray, ToggleCheck, TestToggle&amp;Check
Menu, Tray, Enable, TestToggleEnable <em>; ????????????е????, ??????????????????????.</em>
Menu, Tray, Add, TestDelete <em>; ??????????.</em>
return

TestToggleEnable:
Menu, Tray, ToggleEnable, TestToggleEnable
return

TestDefault:
if (Default = "TestDefault")
{
    Menu, Tray, NoDefault
    Default := ""
}
else
{
    Menu, Tray, Default, TestDefault
    Default := "TestDefault"
}
return

TestStandard:
if (Standard != false)
{
    Menu, Tray, NoStandard
    Standard := false
}
else
{
    Menu, Tray, Standard
    Standard := true
}
return

TestDelete:
Menu, Tray, Delete, TestDelete
return

TestDeleteAll:
Menu, Tray, DeleteAll
return

TestRename:
if (NewName != "renamed")
{
    OldName := "TestRename"
    NewName := "renamed"
}
else
{
    OldName := "renamed"
    NewName := "TestRename"
}
Menu, Tray, Rename, %OldName%, %NewName%
return

Test:
MsgBox, You selected &quot;%A_ThisMenuItem%&quot; in menu &quot;%A_ThisMenu%&quot;.
return</pre>
</div>

<div class="ex" id="ExIcon">
<p><a href="#ExIcon">#4</a>: ??????????????????????н??:</p>
<pre>Menu, FileMenu, Add, Script Icon, MenuHandler
Menu, FileMenu, Add, Suspend Icon, MenuHandler
Menu, FileMenu, Add, Pause Icon, MenuHandler
Menu, FileMenu, Icon, Script Icon, %A_AhkPath%, 2 <em>; ???????е??????????</em>
Menu, FileMenu, Icon, Suspend Icon, %A_AhkPath%, -206 <em>; ??????????? 206 ????????</em>
Menu, FileMenu, Icon, Pause Icon, %A_AhkPath%, -207 <em>; ??????????? 207 ????????</em>
Menu, MyMenuBar, Add, &amp;File, :FileMenu
Gui, Menu, MyMenuBar
Gui, Add, Button, gExit, Exit This Example
Gui, Show
return

MenuHandler:
return

Exit:
ExitApp
</pre>
</div>

<div class="ex" id="ExBoundFunc">
  <p><a href="#ExBoundFunc">#5</a>: ???????????????, ????????<a href="../objects/Functor.htm#BoundFunc">??????????</a> ????????????, ??ú???????????????:</p>
  <pre><em>; ???????????????????????????:</em>
BoundGivePar := Func("GivePar").Bind("First", "Test one")
BoundGivePar2 := Func("GivePar").Bind("Second", "Test two")

<em>; ????????????:</em>
Menu MyMenu, Add, Give parameters, % BoundGivePar
Menu MyMenu, Add, Give parameters2, % BoundGivePar2
Menu MyMenu, Show

<em>; ????????庯?? GivePar:</em>
GivePar(a, b, ItemName, ItemPos, MenuName)
{
    MsgBox % "a:`t`t" a "`n"
           . "b:`t`t" b "`n"
           . "ItemName:`t" ItemName "`n"
           . "ItemPos:`t`t" ItemPos "`n"
           . "MenuName:`t`t" MenuName
}</pre>
</div>
</body>
</html>