<!DOCTYPE HTML>
<html lang="zh">
<head>
<title>#MenuMaskKey - 语法 &amp; 使用 | AutoHotkey v2</title>
<meta name="description" content="The #MenuMaskKey directive changes which key is used to mask WIN or ALT keyup events." />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script type="text/javascript">$(function(){0<=window.navigator.userAgent.toLowerCase().indexOf("ucbrowser")&&CaoNiMaDeUc()})</script>
</head>
<body>

<h1>#MenuMaskKey</h1>

<p>更改用来掩饰(屏蔽) <kbd>Win</kbd> 或 <kbd>Alt</kbd> 键松开事件的按键.</p>

<pre class="Syntax"><span class="func">#MenuMaskKey</span> KeyName</pre>
<h2 id="Parameters">参数</h2>
<dl>

  <dt>KeyName</dt>
  <dd>
    <p>类型: <a href="../Concepts.htm#strings">字符串</a></p>
    <p><a href="../KeyList.htm">按键名称</a>, <a href="../KeyList.htm#vk">VKnn</a>, <a href="../KeyList.htm#sc">SCnnn</a> 或 VKnnSCnnn 序列.</p>
  </dd>

</dl>

<h2 id="Remarks">备注</h2>
<p>掩饰键会自动发送, 以防止开始菜单或活动窗口的菜单栏在未预期的时间激活.</p>
<p>默认的掩饰键为 <kbd>Ctrl</kbd>. 此指令可用于将掩饰键更改为具有较少副作用的键.</p>
<p>好的候选者是通常不会有效果的虚拟按键代码, 例如 vk07, 微软的文档是 "未定义的", 或 vkFF, 它被保留为 "没有映射"(一个没有功能的键). 某些值, 如 0 VK 和非 0 SC, 可能无法抑制开始菜单. 按键码不需要匹配按键的存在.</p>
<p>指定 <code>vk00sc000</code> 将禁用所有自动掩饰.</p>
<p>这个设置是全局的, 这意味着只需要指定一次(在脚本的任何位置) 就可以影响整个脚本的行为.</p>
<p><strong>Hotkeys:</strong> 如果是使用键盘钩子或鼠标钩子实现的热键, 则最终的按键可能对活动窗口和系统是不可见的. 如果系统 <em>仅</em> 检测到 <kbd>Win</kbd> 或 <kbd>Alt</kbd> 按下和松开, 而期间没有其他键按下, 通常会激活一个菜单. 为防止这种情况发生, 键盘或鼠标钩子可能会自动发送掩饰键.</p>
<p>如果满足以下所有条件, 则按下钩子热键将导致下一个 <kbd>Alt</kbd> 或 <kbd>Win</kbd> 键的松开被屏蔽(发送掩饰键):</p>
<ul>
  <li>热键原有功能被屏蔽(没有<a href="../Hotkeys.htm#Tilde">颚化符修饰键</a>).</li>
  <li>当按下热键时, <kbd>Alt</kbd> 或 <kbd>Win</kbd> 逻辑上是按下的.</li>
  <li>修饰符键物理上被按下或热键需要修饰符是激活的. 例如, <code>$#a::</code> 与 <code>AppsKey::RWin</code> 一起使用时, 当 <kbd>Menu</kbd>+<kbd>A</kbd> 按下时发送掩饰键, 但是 <kbd>Menu</kbd> 本身能打开开始菜单.</li>
  <li><kbd>Alt</kbd> is not masked if <kbd>Ctrl</kbd> was down when the hotkey was pressed, since <kbd>Ctrl</kbd>+<kbd>Alt</kbd> does not activate the menu bar.</li>
  <li><kbd>Win</kbd> is not masked if the most recent <kbd>Win</kbd> keydown was modified with <kbd>Ctrl</kbd>, <kbd>Shift</kbd> or <kbd>Alt</kbd>, since the Start Menu does not normally activate in those cases. However, key-repeat occurs even for the <kbd>Win</kbd> key if it was the last key physically pressed, so it can be hard to predict <em>when</em> the most recent <kbd>Win</kbd> keydown was.</li>
  <li>Either the keyboard hook is not installed (i.e. for a mouse hotkey), or there have been no other (unsuppressed) keydown or keyup events since the last <kbd>Alt</kbd> or <kbd>Win</kbd> keydown. Note that key-repeat occurs even for modifier keys and even after sending other keys, but only for the last physically pressed key.</li>
</ul>
<p>Mouse hotkeys may send the mask key immediately if the keyboard hook is not installed.</p>
<p>Hotkeys with the <a href="../Hotkeys.htm#Tilde">tilde modifier</a> are not intended to block the native function of the key, so they do not cause masking. Hotkeys like <code>~#a::</code> still suppress the menu, since the system detects that <kbd>Win</kbd> has been used in combination with another key. However, mouse hotkeys and the <kbd>Win</kbd> keys themselves (<code>~LWin::</code> and <code>~RWin::</code>) do not suppress the Start Menu.</p>
<p>The Start Menu (or the active window's menu bar) can be suppressed by sending any keystroke. The following example disables the ability for the left <kbd>Win</kbd> key to activate the Start Menu, while still allowing its use as a modifier:</p>
<pre>~LWin::Send "{Blind}{vk07}"</pre>
<p><strong>Send:</strong> <a href="Send.htm">Send</a>, <a href="ControlSend.htm">ControlSend</a> and related often release modifier keys as part of their normal operation. 例如, the hotkey <code>&lt;#a::SendText Address</code> usually must release the left <kbd>Win</kbd> key prior to sending the contents of <em>Address</em>, and press the left <kbd>Win</kbd> key back down afterward (so that other <kbd>Win</kbd> key combinations continue working). The mask key may be sent in such cases to prevent a <kbd>Win</kbd> or <kbd>Alt</kbd> keyup from activating a menu.</p>

<h2 id="Related">相关</h2>
<p>See <a href="https://www.autohotkey.com/board/topic/20619-extraneous-control-key-presses-generated-by-or-hotkeys/">this thread</a> for background information.</p>

<h2 id="Examples">示例</h2>
<div class="ex" id="ExBasic">
<p><a href="#ExBasic">#1</a></p>
<pre>#MenuMaskKey vk07  <em>; vk07 is unassigned.</em>
#UseHook
#Space::
!Space::
    KeyWait "LWin"
    KeyWait "RWin"
    KeyWait "Alt"
    KeyHistory
return</pre>
</div>

</body>
</html>