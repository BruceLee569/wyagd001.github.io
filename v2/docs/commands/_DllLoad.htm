<!DOCTYPE HTML>
<html lang="en">
<head>
<title>#DllLoad - 语法 &amp; 使用 | AutoHotkey v2</title>
<meta name="description" content="The #DllLoad directive loads a DLL or EXE file before the script starts executing." />
<meta name="ahk:equiv-v1" content="commands/DllCall.htm#load" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/content.js" type="text/javascript"></script>
<script type="text/javascript">$(function(){0<=window.navigator.userAgent.toLowerCase().indexOf("ucbrowser")&&CaoNiMaDeUc()})</script>
</head>
<body>

 <h1>#DllLoad</h1>

 <p>在脚本开始执行之前<a href="DllCall.htm#load">加载</a> DLL 或 EXE 文件.</p>

 <pre class="Syntax"><span class="func">#DllLoad</span> <span class="optional">FileOrDirName</span></pre>

<dl>
<h2>参数</h2>
   <dt>FileOrDirName</dt>
  <dd>
    <p>类型: <a href="../Concepts.htm#strings">字符串</a></p>
    <p>The path of a file or directory as explained below. This <strong>must not</strong> contain double quotes, wildcards or <a href="../misc/EscapeChar.htm">Escape sequences</a> other than semicolon (<strong>`;</strong>).</p>
    <p>Built-in variables may be used by enclosing them in percent signs (for example, <code>#DllLoad %A_ScriptDir%</code>). Percent signs which are not part of a valid variable reference are interpreted literally. All built-in variables are valid, except for <a href="../misc/ErrorLevel.htm">ErrorLevel</a> and <a href="../Variables.htm#Args">A_Args</a>.</p>
    <p>Known limitation: When compiling a script, variables are evaluated by the compiler and may differ from what the script would return when it is finally executed. The following variables are supported: A_AhkPath, A_AppData, A_AppDataCommon, A_ComputerName, A_ComSpec, A_Desktop, A_DesktopCommon, A_IsCompiled, A_LineFile, A_MyDocuments, A_ProgramFiles, A_Programs, A_ProgramsCommon, A_ScriptDir, A_ScriptFullPath, A_ScriptName, A_Space, A_StartMenu, A_StartMenuCommon, A_Startup, A_StartupCommon, A_Tab, A_Temp, A_UserName, A_WinDir.</p>
    <p><strong>File:</strong> The absolute or relative path to the DLL or EXE file to be loaded. If a relative path is specified, the directive searches for the file using the same search strategy as the system's function <a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-loadlibraryw">LoadLibraryW</a>. Note: <a href="SetWorkingDir.htm">SetWorkingDir</a> has no effect on #DllLoad because #DllLoad is processed before the script begins executing.</p>
    <p><strong>Directory:</strong> Specify a directory instead of a file to alter the search strategy by all subsequent occurrences of #DllLoad which doesn't specify an absolute path to a DLL or EXE. The new search strategy is the same as if <em>Directory</em> was passed to the system's function <a href="https://docs.microsoft.com/en-us/windows/win32/api/winbase/nf-winbase-setdlldirectoryw">SetDllDirectoryW</a>. If this parameter is omitted, the default search strategy is restored.</p>
  </dd>
</dl>
<h2>备注</h2>
<p>Once a DLL or EXE has been loaded by this directive it cannot be unloaded by calling the system's function <a href="https://docs.microsoft.com/en-us/windows/win32/api/libloaderapi/nf-libloaderapi-freelibrary">FreeLibrary</a>. When the script is terminated, all loaded files are unloaded automatically.</p>
<p>The <em>FileName</em> parameter may optionally be preceded by <code>*i</code> and a single space, which causes the program to ignore any failure to load the file. For example: <code>#DllLoad *i MyDLL</code>. This option should be used only when the DLL or EXE is not essential to the main script's operation.</p>
<p>If the <em>FileName</em> parameter specifies a DLL name without a path and the file name extension is omitted, <em>.dll</em> is appended to the file name. To prevent this, include a trailing point character (.) in the file name.</p>
<h2>相关</h2>
<p><a href="DllCall.htm">DllCall</a></p>
<h2>示例</h2>
<div class="ex" id="ExBasic">
<p><a href="#ExBasic">#1</a></p>
<pre>
#DllLoad %A_MyDocuments%\MyDLL.dll</pre>
</div>

 </body>
</html>