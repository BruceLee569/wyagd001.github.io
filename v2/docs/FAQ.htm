<!DOCTYPE HTML>
<html lang="zh">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>常见问题(FAQ) | AutoHotkey v2</title>
<meta name="description" content="This page lists questions and answers about general troubleshooting, common tasks, hotkeys, hotstrings and remapping." />
<link href="static/theme.css" rel="stylesheet" type="text/css" />
<script src="static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>常见问题(FAQ)</h1>

<h2 id="toc">目录</h2>
<p><strong><a href="#general-troubleshooting">一般故障排查</a></strong></p>
<ul>
  <li><a href="#install">如果 AutoHotkey 无法安装我该怎么办?</a></li>
  <li><a href="rightclick">如何恢复 .ahk 文件的右键菜单选项?</a></li>
  <li><a href="#autoexec">为什么我脚本中的某些行总是无法执行?</a></li>
  <li><a href="#vista">为什么我的脚本在前一个系统运行良好却无法工作于 Windows <em>xxx</em>?</a></li>
  <li><a href="#uac">我该如何处理用户账户控制(UAC) 导致的问题?</a></li>
  <li><a href="#DefaultScript">因为脚本出错而无法启动, 我不能通过托盘图标编辑我的脚本. 我能在别的地方找到我的脚本吗?</a></li>
  <li><a href="#Debug">如何查找代码中的错误并修复呢?</a></li>
  <li><a href="#run">为什么 Run 函数不能启动我的游戏或程序?</a></li>
  <li><a href="#nonascii">为什么脚本中的非 ASCII 字符显示或发送不正确?</a></li>
  <li><a href="#games">为什么在某些游戏中热字串, Send 和 MouseClick 不起作用?</a></li>
  <li><a href="#perf">如何在玩游戏或平时 CPU 高负荷运行时改善性能?</a></li>
  <li><a href="#Virus">我的杀毒软件把 AHK 归为恶意软件. 它真的含有病毒吗?</a></li>
</ul>
<p><strong><a href="#common-tasks">常见任务</a></strong></p>
<ul>
  <li><a href="#Download">我可以在哪里找到官方发行版或更旧的版本?</a></li>
  <li><a href="#USB">可以在 USB 驱动器中运行 AHK 代码吗?</a></li>
  <li><a href="#output">如何获取命令行操作的输出?</a></li>
  <li><a href="#close">如何让一个脚本关闭, 暂停或挂起其他的脚本?</a></li>
  <li><a href="#repeat">如何在不退出脚本的情况下停止重复的动作?</a></li>
  <li><a href="#help">如何在任意编辑器中获取上下文相关的 AutoHotkey 函数帮助?</a></li>
  <li><a href="#load">如何检测一个网页何时加载完毕?</a></li>
  <li><a href="#time">如何比较或操作日期与时间?</a></li>
  <li><a href="#SendDate">如何发送当前的日期和/或时间?</a></li>
  <li><a href="#ControlSend">如何发送文本到不活跃或隐藏的窗口?</a></li>
  <li><a href="#winamp">如何控制 Winamp, 即使在它未激活时?</a></li>
  <li><a href="#msgbox">如何改变 MsgBox 的按钮名称?</a></li>
  <li><a href="#DefaultEditor">如何改变默认编辑器, 即通过上下文菜单或托盘图标打开的那个?</a></li>
  <li><a href="#GuiSubmit">如何保存我的 GUI 控件的内容?</a></li>
  <li><a href="#GDIPlus">我能使用 AHK 画点什么吗?</a></li>
  <li><a href="#WinWaitAction">如何在窗口出现, 关闭或变成[不]活跃时执行操作?</a></li>
</ul>
<p><strong><a href="#hotkeys-hotstrings-and-remapping">热键, 热字串和重映射</a></strong></p>
<ul>
  <li><a href="#Startup">如何让我的热键和热字串在 PC 启动时自动生效?</a></li>
  <li><a href="#HotMouse">我在把鼠标按键作为热键使用时遇到问题. 能提供一些建议吗?</a></li>
  <li><a href="#HotSymb">如何将 tab 和空格键设置为热键?</a></li>
  <li><a href="#Remap">如何将按键或鼠标按键重映射成其他键?</a></li>
  <li><a href="#DoublePress">如何检测按键或按钮的双击?</a></li>
  <li><a href="#HotContext">如何让热键或热字串只在特定的程序中有效? 换句话说, 我想让特定的按键执行它原来的功能, 除了当指定的窗口激活时.</a></li>
  <li><a href="#HotPrefix">如何让前缀按键执行它原来的功能, 而不是什么都不做?</a></li>
  <li><a href="#HotOverride">如何改变或禁用 Windows 内置的快捷键, 例如 Win+U(辅助工具管理器) 和 Win+R(运行)?</a></li>
  <li><a href="#HotRegex">如何在热字串中使用通配符或正则表达式?</a></li>
  <li><a href="#SpecialKey">如何将不存在于我键盘布局中的键作为热键使用?</a></li>
  <li><a href="#HotZero">我的小键盘上有个特殊的 000 键. 可以把它设成热键吗?</a></li>
</ul>

<h2 id="general-troubleshooting">一般故障排查</h2>
<h3 id="install">如果 AutoHotkey 无法安装我该怎么办?</h3>
<p id="install-7z"><strong>7-zip 错误:</strong> 使用 7-zip 或其他解压缩软件解压安装程序 EXE, 然后运行 setup.exe 或 Installer.ahk(拖拽 Installer.ahk 到 AutoHotkeyU32.exe 上即可).</p>
<p>AutoHotkey 的安装程序(exe 文件) 以 7-zip 自解压格式打包, 安装时尝试解压文件到用户的临时文件夹并执行编译的脚本进行安装. 有时系统策略或其他原因阻止了文件的解压或执行. 通常在遇到这种情况时会显示"7-zip 错误"这样一个消息. 手动解压文件到不同的目录或许能解决该问题.</p>
<p id="install-hang"><strong>安装挂死:</strong> 如果安装窗口显示空白或不显示, 尝试下面的解决方案:</p>
<ul><li>在安装程序启动时, 按住 <kbd>Ctrl</kbd> 或 <kbd>Shift</kbd>. 如果出现 UAC 提示, 按住 <kbd>Ctrl</kbd> 或 <kbd>Shift</kbd> 并点击“是或继续". 你应该能看到询问是否你要以默认选项安装的提示.</li>
<li>以<a href="Program.htm#install">命令行选项</a>安装. 如果你手动解压安装程序的 Exe 文件, 使用 <code>setup.exe /S</code> 或 <code>AutoHotkeyU32.exe Installer.ahk /S</code>.</li>
</ul>
<p><strong>其他:</strong> 以上建议基本能解决遇到的大多数问题. 更进一步的援助, 请到论坛发帖求助.</p>

<h3 id="rightclick">如何恢复 .ahk 文件的右键菜单选项?</h3>
<p>通常情况下, 如果安装了 AutoHotkey, 右键单击 AutoHotkey 脚本文件(.ahk) 应该会提供以下选项:</p>
<ul>
  <li>Run Script(运行脚本)</li>
  <li>Compile Script(编译脚本)(取决于 <em>Install script compiler</em> 安装选项)</li>
  <li>Edit Script(编辑脚本)</li>
  <li>Run as administrator(以管理员权限运行)(如果在 AutoHotkey 安装时启用了 UAC)</li>
  <li>Run with UI Access(以 UI Access 运行)(如果在安装期间启用了<a href="Program.htm#Installer_uiAccess">该选项</a>)</li>
</ul>
<p>有时这些选项会被当前用户配置文件中的设置覆盖, 例如是否使用 <em>Open With(打开方式)</em> 更改了打开 .ahk 文件的默认程序. 可以通过删除以下注册表键来解决此问题:</p>
<pre class="no-highlight">HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.ahk\UserChoice</pre>
<p>这可以通过应用<a href="misc/remove-userchoice.reg" download="remove-userchoice.reg">此注册表文件</a>来完成.</p>
<p>还可能需要修复默认注册表值, 方法是重新安装 AutoHotkey 或运行 AutoHotkey Setup(从开始菜单) 并在窗口顶部选择 <em>apply(应用)</em>.</p>

<h3 id="autoexec">为什么我脚本中的某些行总是无法执行?</h3>
<p>任何想在脚本启动时立即执行的行都应该出现在脚本的顶部, 要在首个<a href="Hotkeys.htm">热键</a>, <a href="Hotstrings.htm">热字串</a>或 <a href="commands/Return.htm">Return</a> 之前. 有关详情, 请参阅<a href="Scripts.htm#auto">自动执行段</a>.</p>
<p>还有, 含有多行执行语句的<a href="Hotkeys.htm">热键</a>必须把它的首行写在热键的 <em>下面</em> 而不能在同一行. 例如:</p>
<pre>#space::  <em>;  Win+空格键</em>
Run "Notepad"
WinWaitActive "Untitled - Notepad"
WinMaximize
return</pre>
<h3 id="vista">为什么我的脚本在前一个系统运行良好却无法工作于 Windows <em>xxx</em>?</h3>
<p>这个问题有许多的影响因素, 例如:</p>
<ul>
  <li>我已经升级了我的电脑或系统, 现在我的脚本无法工作.</li>
  <li>当程序以管理员权限运行时, 热键或热字串不工作.</li>
  <li>系统阻止自动化操作(例如 磁盘管理忽略 Send).</li>
</ul>
<p>当切换操作系统时, 发生的变动也许影响了你的脚本. 例如, 你的新电脑, 可能有不同的驱动或安装了其他的软件. 如果你升级了新版本的 AutoHotkey, 确认你之前使用的是哪个版本并检查<a href="ChangeLog.htm">更新历史</a>和<a href="Compat.htm">脚本兼容性</a>.</p>
<p><a href="commands/SoundGet.htm">SoundGet</a> 和 <a href="commands/SoundSet.htm">SoundSet</a> 在 Vista 及之后系统的行为不同于早期版本的 Windows. 尤其是, 设备的设备号是不同的并且某些组件可能不可用. 依赖于音频驱动程序的行为, 必定与在 XP 时是不同的. 这<a href="commands/SoundSet.htm#Ex">声卡分析脚本</a>能用于找出正确的设备号.</p>
<p>也请参考以下问题:</p>

<h3 id="uac">我该如何处理用户账户控制(UAC) 导致的问题?</h3>
<p><a href="http://windows.microsoft.com/en-US/windows7/What-is-User-Account-Control">用户账户控制(UAC)</a> 是导致问题的常见原因, 特别在系统由 Windows XP/Vista/7 升级到 Vista/7/8/10 时. UAC 存在于 Windows Vista 及更后的系统, 在新系统或新安装时默认是被激活的, 并且在 Windows 8 及之后的系统中很难被禁止.</p>
<p>在默认情况下, UAC 保护 "提权" 程序(程序以管理员权限运行) 不被非提权程序自动化, 因为这将允许他们绕过安全限制. 热键也将被屏蔽, 因此, 非提权程序不能监视用于提权程序的输入.</p>
<p>UAC 也阻止了 <a href="commands/Send.htm#SendPlayDetail">SendPlay</a> 和 <a href="commands/BlockInput.htm">BlockInput</a> 的正常工作.</p>
<p>常见的解决方案如下:</p>
<ul>
  <li>选中激活安装器界面上的<em><a href="Program.htm#Installer_uiAccess">增加 'Run with UI Access'(以 UI Access 运行) 到上下文菜单</a></em> 这个选项. 在开始菜单中运行安装程序, 该选项能被开启或关闭而不用重新安装 AutoHotkey. 该选项开启后, 右键选中的脚本文件选择 <em>Run with UI Access(以 UI Access 运行)</em>, 或者使用<a href="Scripts.htm#cmd">命令行</a>例如, <code>"AutoHotkeyU32_UIA.exe" "要打开的脚本文件名.ahk"</code>(可能需要包括完整路径).</li>
  <li><a href="Variables.htm#IsAdmin">以管理员权限</a>运行脚本. 注意这样的脚本中运行的任何程序也具有管理员权限. </li>
  <li>关闭<a href="http://windows.microsoft.com/en-US/windows7/What-is-User-Account-Control">用户账户控制</a>(不推荐), 在 Windows 8 或之后的版本您还必须禁用"以管理员核准模式运行所有管理员(Run all administrators in Admin Approval Mode)"安全设置(也不推荐). </li>
  <li>完全禁用 UAC. 不推荐这样做, 在 Windows 8 或之后的系统中会导致系统出现一些问题, 例如无法运行 Edge 和应用商店以及其安装的程序.</li>
</ul>

<h3 id="DefaultScript">因为脚本出错而无法启动, 我不能通过托盘图标编辑我的脚本. 我该怎么办?</h3>
<p>首先您必须修复您脚本中的错误才能找回 AHK 的系统托盘图标. 但是您必须先找到您的脚本.</p>
<p>请在下面的文件夹中寻找 AutoHotkey.ahk 文件:</p>
<ul>
  <li>你的 <em>文档</em>(或 <em>我的文档</em>) 文件夹.</li>
  <li>安装 AutoHotkey 的文件夹, 通常是 C:\Program Files\AutoHotkey. 如果您正在使用 AutoHotkey 而没有安装它, 请查看包含 AutoHotkey.exe 的目录.</li>
</ul>
<p>如果你直接运行另一个 AutoHotkey 可执行文件, 脚本名称取决于可执行文件. 例如, 如果您运行的是 AutoHotkeyU32.exe, 那么请查找 AutoHotkeyU32.ahk. 请注意, 根据你的系统设置这 ".ahk" 部分(扩展名) 可能是隐藏的, 但是文件一定有类似 <img src="static/ahkfile16.png" alt="[H]"> 这样的图标.</p>
<p>您可以随时从右键菜单中选择 <em>Edit Script</em> 来编辑 AHK 脚本. 如果这个右键菜单命令无效, 您还可以用记事本或其他文本编辑器来编辑.</p>
<p>如果您是从开始菜单中运行 AutoHotkey 或是直接双击 AutoHotkey.exe 来运行(不包含任何命令行参数), 那么它会查找上述的脚本来执行. 否则, 您可以在任意位置创建一个其他名称的 AHK 脚本文件(something.ahk), 然后运行 AHK 脚本, 而不是 AutoHotkey.</p>
<p>另请参阅<a href="Scripts.htm#defaultfile">命令行参数 &quot;Script Filename&quot;</a>和 <a href="Program.htm#portability">AutoHotkey.exe 的可移植性.</p>
<h3 id="Debug">如何查找代码中的错误并修复呢?</h3>
<p>对于简单的脚本, 请参阅 <a href="Scripts.htm#debug">调试脚本</a>. 要查看变量的内容, 请使用 <a href="commands/MsgBox.htm">MsgBox</a> 或 <a href="commands/ToolTip.htm">ToolTip</a>. 对于复杂的脚本, 请参阅<a href="Scripts.htm#idebug">交互式调试</a>.</p>
<h3 id="run">为什么 <a href="commands/Run.htm">Run</a> 函数不能启动我的游戏或程序?</h3>
<p>有些程序需要在它们自己的目录下运行(不能确定时, 通常最好这样做). 例如:</p>
<pre>Run A_ProgramFiles "\Some Application\App.exe", A_ProgramFiles "\Some Application"</pre>
<p>如果你想要打开的程序位于 <code>A_WinDir "\System32"</code> 并且你是在 64 位系统中使用 32 位的 AutoHotkey, <a href="https://msdn.microsoft.com/en-us/library/aa384187">File System Redirector</a> 将会产生干扰. 为避免该问题, 请使用 <code>A_WinDir "\SysNative"</code> 代替; 这是一个仅在 64 位系统上运行的 32 位程序可见的虚拟目录.</p>

<h3 id="nonascii">为什么脚本中的非 ASCII 字符显示或发送不正确?</h3>
<p>简短的回答: 将脚本保存为带有 BOM 的 UTF-8.</p>
<p>虽然 AutoHotkey 支持 Unicode 文本, 但它是为了向后兼容而优化的, 这意味着默认为 ANSI 编码, 而不是国际上推荐的 UTF-8. 除非以字节顺序标记开始, 否则 AutoHotkey 不会自动识别 UTF-8 文件.</p>
<p>换句话说, 缺少字节顺序标记的 UTF-8 文件被错误地解释, 导致非 ASCII 字符被错误地解码. 要解决此问题, 请将文件保存为带有 BOM 的 UTF-8 文件或<a href="Scripts.htm#cp">添加 /CP65001 命令行开关</a>.</p>
<p>要在记事本中保存为带有 BOM 的 UTF-8 文件, 请在另存为对话框的 <em>编码</em> 下拉菜单中选择 <em>UTF-8</em>.</p>
<p>要读取缺少字节顺序标记的其他 UTF-8 文件, 请使用 <code><a href="commands/FileEncoding.htm">FileEncoding</a> UTF-8-RAW</code>, <a href="commands/FileRead.htm">FileRead</a> 的 <code>*P65001</code> 选项, 或 <a href="commands/FileOpen.htm">FileOpen</a> 的第三个参数<code>"UTF-8-RAW"</code>. <code>-RAW</code> 后缀可以省略, 但是在这种情况下, 任何新创建的文件都会有一个字节顺序标记.</p>
<p>请注意, 使用标准 INI 函数访问 INI 文件不支持 UTF-8; 它们必须保存为 ANSI 或 UTF-16

<h3 id="games">为什么在某些游戏中 <a href="Hotstrings.htm">Hotstrings</a>, <a href="commands/Send.htm">Send</a> 和 <a href="commands/Click.htm">Click</a> 不起作用?</h3>
<p>不是所有的游戏都支持 AHK 发送键击和点击或获取像素颜色.</p>
<p>有一些替代方法, 请试试下面提及的方案. 如果这些都无效, 那么 AHK 可能不适用于您的游戏. 一些游戏含有防止反破解和作弊的措施, 如 GameGuard 和 Hackshield. 如果是, 则 AutoHotkey 很可能无法用于该游戏.</p>
<ul>
  <li>
  <p>通过 <a href="commands/Send.htm#SendPlay">SendPlay</a> 函数, <a href="commands/SendMode.htm">SendMode Play</a> 或<a href="Hotstrings.htm">热字串选项 SP</a> 来使用 SendPlay.</p>
  <pre>SendPlay "abc"</pre>
  <pre>SendMode "Play"
Send "abc"</pre>
  <pre>:SP:btw::by the way

<em>; 或</em>

#Hotstring SP
::btw::by the way</pre>
  <p class="note"><strong>注意</strong>: SendPlay 在启用了用户账户控制的 Windows Vista 或更高版本中可能没有效果, 即使以管理员权限运行脚本.</p>
  </li>
  <li>
  <p>使用 <a href="commands/SetKeyDelay.htm">SetKeyDelay</a> 增加延迟. 例如:</p>
  <pre>SetKeyDelay 0, 50
SetKeyDelay 0, 50, "Play"</pre>
  </li>
  <li>
  <p>试试 <a href="commands/ControlSend.htm">ControlSend</a>, 在其他 Send 模式无效时它可能可以:</p>
  <pre>ControlSend "abc",, <i>GameTitle</i></pre>
  </li>
  <li>
  <p>试试在多种发送方式中使用按键的按下和弹起事件:</p>
  <pre>Send "{<i>KEY</i> Down}{<i>KEY</i> Up}"</pre>
  </li>
  <li>
  <p>试试在按键的按下事件和弹起事件之间使用 <a href="commands/ControlSend.htm">Sleep</a>:</p>
  <pre>Send "{<i>KEY</i> down}"
Sleep 10 <em>; 试试不同的毫秒数.</em>
Send "{<i>KEY</i> up}"</pre>
  </li>
</ul>
<h3 id="perf">如何在玩游戏或平时 CPU 高负荷运行时改善性能?</h3>
<p>如果脚本中的 <a href="Hotkeys.htm">Hotkeys</a>, <a href="commands/Click.htm">Clicks</a>, or <a href="commands/Send.htm">Sends</a> 在 CPU 高负荷运行时明显比正常情况下要慢, 提高脚本程序的优先级或许会有帮助. 要提高脚本进程的优先级, 在脚本开始的部分写入下面这行语句:</p>
<pre><a href="commands/ProcessSetPriority.htm">ProcessSetPriority</a> "High"</pre>
<h3 id="Virus">我的杀毒软件把 AutoHotkey 或已编译脚本标记为恶意软件. 它真的是病毒吗?</h3>
<p>尽管文件被感染确实是可能的, 但多数情况下这些警报都是 <em>误报</em>, 这意味着防病毒程序是错误的. 一个常见的建议是将文件上传到在线服务, 例如 <a href="https://www.virustotal.com/">virustotal</a> 或 <a href="https://virusscan.jotti.org/">Jotti</a> 看看其他杀毒软件的查杀结果. 如果有疑问, 您可以将该文件发送给您的杀毒软件供应商确认. 这也可能有助于我们和其他 AutoHotkey 用户, 因为供应商可能会确认这是误报和改善他们的产品与 AutoHotkey 的兼容性.</p>
<p>对于已压缩的编译脚本来说, 误报可能更为常见, 例如使用 UPX(AutoHotkey 1.0 默认, AutoHotkey 1.1 中移除) 或 MPRESS(在AutoHotkey 1.1 中可选). AutoHotkey 安装时不带有压缩程序, 编译脚本时也默认不压缩.</p>

<h2 id="common-tasks">常见任务</h2>

<h3 id="Download">我可以在哪里找到官方发行版或更旧的版本?</h3>
<p>访问 <a href="https://autohotkey.com/download/">AutoHotkey 下载页面</a>.</p>
<h3 id="USB">可以在 USB 驱动器中运行 AHK 吗?</h3>
<p>请参阅 <a href="Program.htm#portability">AutoHotkey.exe 的可移植性</a>. Note that if you use auto-included function libraries, AutoHotkey.exe and the Lib folder must be up one level from Ahk2Exe.exe (e.g. \AutoHotkey.exe vs \Compiler\Ahk2Exe.exe). Also note that Ahk2Exe saves settings to the following registry key: <code>HKCU\Software\AutoHotkey\Ahk2Exe</code>.</p>
<h3 id="output">如何检索命令行操作的输出?</h3>
<p>Testing shows that due to file caching, a temporary file can be very fast for relatively small outputs. In fact, if the file is deleted immediately after use, it often does not actually get written to disk. 例如:</p>
<pre><a href="commands/Run.htm">RunWait</a> A_ComSpec ' /c dir &gt; C:\My Temp File.txt'
VarToContainContents := FileRead("C:\My Temp File.txt")
FileDelete "C:\My Temp File.txt"</pre>
<p>To avoid using a temporary file (especially if the output is large), consider using the <a href="commands/Run.htm#StdOut">Shell.Exec()</a> method as shown in the examples for the <a href="commands/Run.htm">Run</a> function.</p>
<h3 id="close">如何让一个脚本关闭, 暂停或挂起其他的脚本?</h3>
<p>First, here is an example that closes another script:</p>
<pre>DetectHiddenWindows True  <em>; Allows a script's hidden main window to be detected.</em>
SetTitleMatchMode 2  <em>; Avoids the need to specify the full path of the file below.</em>
WinClose "Script's File Name.ahk - AutoHotkey"  <em>; Update this to reflect the script's name (case sensitive).</em></pre>
<p>To <a href="commands/Suspend.htm">suspend</a> or <a href="commands/Pause.htm">pause</a> another script, replace the last line above with one of these:</p>
<pre>PostMessage 0x111, 65305,,, "Script's File Name.ahk - AutoHotkey"  <em>; Suspend.</em>
PostMessage 0x111, 65306,,, "Script's File Name.ahk - AutoHotkey"  <em>; Pause.</em></pre>
<h3 id="repeat">如何在不退出脚本的情况下停止重复的动作?</h3>
<p>To pause or resume the entire script at the press of a key, assign a hotkey to the <a href="commands/Pause.htm">Pause</a> function as in this example:</p>
<pre>^!p::Pause  <em>; Press Ctrl+Alt+P to pause. Press it again to resume.</em></pre>
<p>To stop an action that is repeating inside a <a href="commands/Loop.htm">Loop</a>, consider the following working example, which is a hotkey that both starts and stops its own repeating action. In other words, pressing the hotkey once will start the Loop. Pressing the same hotkey again will stop it.</p>
<pre>#MaxThreadsPerHotkey 3
<strong>#z::  <em>; Win+Z hotkey (change this hotkey to suit your preferences).</em></strong>
#MaxThreadsPerHotkey 1
if KeepWinZRunning  <em>; This means an underlying <a href="misc/Threads.htm">thread</a> is already running the loop below.</em>
{
    KeepWinZRunning := false  <em>; Signal that thread's loop to stop.</em>
    return  <em>; End this thread so that the one underneath will resume and see the change made by the line above.</em>
}
<em>; Otherwise:</em>
KeepWinZRunning := true
Loop
{
    <strong><em>; The next four lines are the action you want to repeat (update them to suit your preferences):</em></strong>
    ToolTip "Press Win-Z again to stop this from flashing."
    Sleep 1000
    ToolTip
    Sleep 1000
    <strong><em>; But leave the rest below unchanged.</em></strong>
    if not KeepWinZRunning  <em>; The user signaled the loop to stop by pressing Win-Z again.</em>
        break  <em>; Break out of this loop.</em>
}
KeepWinZRunning := false  <em>; Reset in preparation for the next press of this hotkey.</em>
return</pre>
<h3 id="help">如何在任意编辑器中获取上下文相关的 AutoHotkey 函数帮助?</h3>
<p>Rajat created <a href="scripts/ContextSensitiveHelp.htm">this script</a>.</p>
<h3 id="load">如何检测一个网页何时加载完毕?</h3>
<p>With Internet Explorer, perhaps the most reliable method is to use DllCall and COM as demonstrated at <a href="http://www.autohotkey.com/forum/topic19256.html">www.autohotkey.com/forum/topic19256.html</a>. On a related note, the contents of the address bar and status bar can be retrieved as demonstrated at <a href="http://www.autohotkey.com/forum/topic19255.html">www.autohotkey.com/forum/topic19255.html</a>.</p>
<p><strong>Older, less reliable method:</strong> The technique in the following example will work with MS Internet Explorer for most pages. A similar technique might work in other browsers:</p>
<pre>Run "www.yahoo.com"
MouseMove 0, 0  <em>; Prevents the status bar from showing a mouse-hover link instead of &quot;Done&quot;.</em>
WinWait "Yahoo! - "
WinActivate
<a href="commands/StatusBarWait.htm">StatusBarWait</a> "Done", 30
if ErrorLevel
    MsgBox "The wait timed out or the window was closed."
else 
    MsgBox "The page is done loading."</pre>
<h3 id="time">如何比较或操作日期与时间?</h3>
<p>The <a href="commands/DateAdd.htm">DateAdd</a> function can add or subtract a quantity of days, hours, minutes, or seconds to a time-string that is in the <a href="commands/FileSetTime.htm#YYYYMMDD">YYYYMMDDHH24MISS</a> format. The following example subtracts 7 days from the specified time:</p>
<pre>Result := DateAdd(VarContainingTimestamp, -7, "days")</pre>
<p>To determine the amount of time between two dates or times, 请参阅 <a href="commands/DateDiff.htm">DateDiff</a>, which gives an example. Also, the built-in variable <a href="Variables.htm#Now">A_Now</a> contains the current local time. Finally, there are several built-in <a href="Variables.htm#date">date/time variables</a>, as well as the <a href="commands/FormatTime.htm">FormatTime</a> function to create a custom date/time string.</p>
<h3 id="SendDate">如何发送当前的日期和/或时间?</h3>
<p>Use <a href="commands/FormatTime.htm">FormatTime</a> or <a href="Variables.htm#date">built-in variables for date and time</a>.</p>
<h3 id="ControlSend">如何发送文本到不活跃或隐藏的窗口?</h3>
<p>Use <a href="commands/ControlSend.htm">ControlSend</a>.</p>
<h3 id="winamp">如何控制 Winamp, 即使在它未激活时?</h3>
<p>See <a href="misc/Winamp.htm">Automating Winamp</a>.</p>
<h3 id="msgbox">如何改变 <a href="commands/MsgBox.htm">MsgBox</a> 的按钮名称?</h3>
<p>Here is an <a href="scripts/MsgBoxButtonNames.htm">example</a>.</p>
<h3 id="DefaultEditor">如何改变默认编辑器, 即通过上下文菜单或托盘图标打开的那个?</h3>
<p>In the example section of <a href="commands/Edit.htm">Edit</a> you will find a script that allows you to change the default editor.</p>
<h3 id="GuiSubmit">如何保存我的 GUI 控件的内容?</h3>
<p>Use <a href="objects/Gui.htm#Submit">Gui.Submit</a>. 例如:</p>
<pre>Gui := GuiCreate()
Gui.Add("Text",, "Enter some Text and press Submit:")
Gui.Add("Edit", "vMyEdit")
Gui.Add("Button",, "Submit").OnEvent("Click", "Submit")
Gui.Show

Submit(Btn)
{
    Saved := Btn.Gui.Submit(false)
    MsgBox "Content of the edit control: " Saved.MyEdit
}</pre>
<h3 id="GDIPlus">我能使用 AHK 画点什么吗?</h3>
<p>See <a href="http://www.autohotkey.com/forum/topic32238.html">GDI+ standard library</a> by tic. It's also possible with some rudimentary methods using Gui, but in a limited way.</p>
<h3 id="WinWaitAction">如何在窗口出现, 关闭或变成[不]活跃时开始一个动作?</h3>
<p>Use <a href="commands/WinWait.htm">WinWait</a>, <a href="commands/WinWaitClose.htm">WinWaitClose</a> or <a href="commands/WinWaitActive.htm">WinWait[Not]Active</a>.</p>
<p>There are also user-created solutions such as <a href="https://autohotkey.com/boards/viewtopic.php?f=6&t=6463">OnWin.ahk</a> and <a href="https://autohotkey.com/board/topic/80644-how-to-hook-on-to-shell-to-receive-its-messages/">[How to] Hook on to Shell to receive its messages</a>.</p>
<h2 id="hotkeys-hotstrings-and-remapping">Hotkeys, Hotstrings, and Remapping</h2>
<h3 id="Startup">如何让我的热键和热字串在 PC 启动时自动生效?</h3>
<p>There are several ways to make a script (or any program) launch automatically every time you start your PC. The easiest is to place a shortcut to the script in the Startup folder:</p>
<ol>
  <li>Find the script file, select it, and press <kbd>Control</kbd>+<kbd>C</kbd>.</li>
  <li>Press <kbd>Win</kbd>+<kbd>R</kbd> to open the Run dialog, then enter <code>shell:startup</code> and click OK or <kbd>Enter</kbd>. This will open the Startup folder for the current user. To instead open the folder for all users, enter <code>shell:common startup</code> (however, in that case you must be an administrator to proceed).</li>
  <li>Right click inside the window, and click "Paste Shortcut". The shortcut to the script should now be in the Startup folder.</li>
</ol>
<h3 id="HotMouse">我在把鼠标按键作为热键使用时遇到问题. 能提供一些建议吗?</h3>
<p>The left and right mouse buttons should be assignable normally (例如, <code>#LButton::</code> is the <kbd>Win</kbd>+LeftButton hotkey). Similarly, the middle button and the turning of the <a href="KeyList.htm">mouse wheel</a> should be assignable normally except on mice whose drivers directly control those buttons.</p>
<p> The fourth button (XButton1) and the fifth button (XButton2) might be assignable if your mouse driver allows their clicks to be <a href="commands/KeyHistory.htm">seen</a> by the system. If they cannot be seen -- or if your mouse has more than five buttons that you want to use -- you can try configuring the software that came with the mouse (sometimes accessible in the Control Panel or Start Menu) to send a keystroke whenever you press one of these buttons. Such a keystroke can then be defined as a hotkey in a script. 例如, if you configure the fourth button to send <kbd>Control</kbd>+<kbd>F1</kbd>, you can then indirectly configure that button as a hotkey by using <code>^F1::</code> in a script.</p>
<p>If you have a five-button mouse whose fourth and fifth buttons cannot be <a href="commands/KeyHistory.htm">seen</a>, you can try changing your mouse driver to the default driver included with the OS. This assumes there is such a driver for your particular mouse and that you can live without the features provided by your mouse's custom software.</p>
<h3 id="HotSymb">如何将 tab 和空格键定义为热键?</h3>
<p>Use the names of the keys (Tab and Space) rather than their characters. 例如, <code>#Space</code> is <kbd>Win</kbd>+<kbd>Space</kbd> and <code>^!Tab</code> is <kbd>Control</kbd>+<kbd>Alt</kbd>+<kbd>Tab</kbd>.</p>
<h3 id="Remap">如何将按键或鼠标按钮重映射成其他键?</h3>
<p>This is described on the <a href="misc/Remap.htm">remapping</a> page.</p>
<h3 id="DoublePress">如何检测按键或按钮的双击?</h3>
<p>Use <a href="Variables.htm#h">built-in variables for hotkeys</a> as follows:</p>
<pre>~Ctrl::
    if (A_ThisHotkey = A_PriorHotkey &amp;&amp; A_TimeSincePriorHotkey &lt; 200)
        MsgBox "double-press"
return</pre>
<h3 id="HotContext">如何让<a href="Hotkeys.htm">热键</a>或<a href="Hotstrings.htm">热字串</a>只在特定的程序中有效? 换句话说, 在特定的窗口不活动时我想让特定的按键执行它原来的功能.</h3>
<p>The preferred method is <a href="commands/_If.htm">#If</a>. 例如:</p>
<pre>#if WinActive("ahk_class Notepad")
^a::MsgBox "You pressed Control-A while Notepad is active."
</pre>
<h3 id="HotPrefix">如何让前缀按键执行它原来的功能, 而不是什么都不做?</h3>
<p>Consider the following example, which makes Numpad0 into a prefix key:</p>
<pre>Numpad0 &amp; Numpad1::MsgBox "You pressed Numpad1 while holding down Numpad0."</pre>
<p>Now, to make Numpad0 send a real Numpad0 keystroke whenever it wasn't used to launch a hotkey such as the above, add the following hotkey:</p>
<pre> $Numpad0::Send "{Numpad0}"</pre>
<p>The $ prefix is needed to prevent a warning dialog about an infinite loop (since the hotkey &quot;sends itself&quot;). In addition, the above action occurs at the time the key is <strong>released.</strong></p>
<h3 id="HotOverride">如何改变或禁用 Windows 内置的快捷键, 例如 Win+U(辅助工具管理器) 和 Win+R(运行)?</h3>
<p>这里有一些<a href="misc/Override.htm">示例</a>.</p>
<h3 id="HotRegex">如何在热字串中使用通配符或正则表达式?</h3>
<p>使用 polyethene 写的<a href="https://github.com/polyethene/AutoHotkey-Scripts/blob/master/Hotstrings.ahk">脚本</a>(含示例).</p>
<h3 id="SpecialKey">如何将不存在于我键盘布局中的键作为热键使用?</h3>
<p>请参阅<a href="KeyList.htm#SpecialKeys">特殊按键</a>.</p>
<h3 id="HotZero">我的小键盘上有个特殊的 000 键. 可以把它设成热键吗?</h3>
<p>You can. 这个<a href="scripts/Numpad000.htm">示例脚本</a>将 <kbd>000</kbd> 键设成等号键. 你可以通过使用你的代码替换 <code>Send "="</code> 这行来更改这个动作.</p>
</body>
</html>